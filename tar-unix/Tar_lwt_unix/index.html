<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tar_lwt_unix (tar-unix.Tar_lwt_unix)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">tar-unix</a> &#x00BB; Tar_lwt_unix</nav><header class="odoc-preamble"><h1>Module <code><span>Tar_lwt_unix</span></code></h1><p>Lwt_unix I/O for tar-formatted data</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-decode_error"><a href="#type-decode_error" class="anchor"></a><code><span><span class="keyword">type</span> decode_error</span><span> = </span><span>[ </span></code><ol><li id="type-decode_error.Fatal" class="def variant constructor anchored"><a href="#type-decode_error.Fatal" class="anchor"></a><code><span>| </span><span>`Fatal <span class="keyword">of</span> <a href="../../tar/Tar/index.html#type-error">Tar.error</a></span></code></li><li id="type-decode_error.Unix" class="def variant constructor anchored"><a href="#type-decode_error.Unix" class="anchor"></a><code><span>| </span><span>`Unix <span class="keyword">of</span> <span class="xref-unresolved">Unix</span>.error * string * string</span></code></li><li id="type-decode_error.Unexpected_end_of_file" class="def variant constructor anchored"><a href="#type-decode_error.Unexpected_end_of_file" class="anchor"></a><code><span>| </span><span>`Unexpected_end_of_file</span></code></li><li id="type-decode_error.Msg" class="def variant constructor anchored"><a href="#type-decode_error.Msg" class="anchor"></a><code><span>| </span><span>`Msg <span class="keyword">of</span> string</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_decode_error"><a href="#val-pp_decode_error" class="anchor"></a><code><span><span class="keyword">val</span> pp_decode_error : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-decode_error">decode_error</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span><span>(<span class="type-var">'a</span>, <span>[&gt; <a href="#type-decode_error">decode_error</a> ]</span> <span class="keyword">as</span> 'b, <a href="#type-t">t</a>)</span> <a href="../../tar/Tar/index.html#type-t">Tar.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-value"><a href="#val-value" class="anchor"></a><code><span><span class="keyword">val</span> value : <span><span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'err</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'err</span>, <a href="#type-t">t</a>)</span> <a href="../../tar/Tar/index.html#type-t">Tar.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : 
  <span><span>(<span><span class="optlabel">?global</span>:<a href="../../tar/Tar/Header/Extended/index.html#type-t">Tar.Header.Extended.t</a> <span class="arrow">&#45;&gt;</span></span>
    <span><a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a> <span class="arrow">&#45;&gt;</span></span>
    <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
    <span><span>(<span class="type-var">'a</span>, <span>[&gt; <a href="#type-decode_error">decode_error</a> ]</span> <span class="keyword">as</span> 'err, <a href="#type-t">t</a>)</span> <a href="../../tar/Tar/index.html#type-t">Tar.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'err</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>fold f filename acc</code> folds over the tar archive. The function <code>f</code> is called for each <code>hdr : Tar.Header.t</code>. It should forward the position in the file descriptor by <code>hdr.Tar.Header.file_size</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-extract"><a href="#val-extract" class="anchor"></a><code><span><span class="keyword">val</span> extract : 
  <span><span class="optlabel">?filter</span>:<span>(<span><a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[&gt; <span>`Exn of exn</span> <span>| <a href="#type-decode_error">decode_error</a></span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>extract ~filter ~src dst</code> extracts the tar archive <code>src</code> into the directory <code>dst</code>. If <code>filter</code> is provided (defaults to <code>fun _ -&gt; true</code>), any file where <code>filter hdr</code> returns <code>false</code>, is skipped. No directories are created including <code>dst</code> and any (implicit or explicit) directories in the archive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span class="optlabel">?level</span>:<a href="../../tar/Tar/Header/index.html#type-compatibility">Tar.Header.compatibility</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?global</span>:<a href="../../tar/Tar/Header/Extended/index.html#type-t">Tar.Header.Extended.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?filter</span>:<span>(<span><a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[ <span>`Msg of string</span> <span><span>| `Unix</span> of <span class="xref-unresolved">Unix</span>.error * string * string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>create ~level ~filter ~src dst</code> creates a tar archive at <code>dst</code>. It uses <code>src</code>, a directory name, as input. If <code>filter</code> is provided (defaults to <code>fun _ -&gt; true</code>), any file where <code>filter hdr</code> returns <code>false</code> is skipped.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header_of_file"><a href="#val-header_of_file" class="anchor"></a><code><span><span class="keyword">val</span> header_of_file : 
  <span><span class="optlabel">?level</span>:<a href="../../tar/Tar/Header/index.html#type-compatibility">Tar.Header.compatibility</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a>, <span>[ <span>`Msg of string</span> <span><span>| `Unix</span> of <span class="xref-unresolved">Unix</span>.error * string * string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>header_of_file ~level filename</code> returns the tar header of <code>filename</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-append_file"><a href="#val-append_file" class="anchor"></a><code><span><span class="keyword">val</span> append_file : 
  <span><span class="optlabel">?level</span>:<a href="../../tar/Tar/Header/index.html#type-compatibility">Tar.Header.compatibility</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?header</span>:<a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[ <span>`Msg of string</span> <span><span>| `Unix</span> of <span class="xref-unresolved">Unix</span>.error * string * string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>append_file ~level ~header filename fd</code> appends the contents of <code>filename</code> to the tar archive <code>fd</code>. If <code>header</code> is not provided, <code>header_of_file</code> is used for constructing a header.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_header"><a href="#val-write_header" class="anchor"></a><code><span><span class="keyword">val</span> write_header : 
  <span><span class="optlabel">?level</span>:<a href="../../tar/Tar/Header/index.html#type-compatibility">Tar.Header.compatibility</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../tar/Tar/Header/index.html#type-t">Tar.Header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[ <span>`Msg of string</span> <span><span>| `Unix</span> of <span class="xref-unresolved">Unix</span>.error * string * string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>write_header ~level hdr fd</code> writes the header <code>hdr</code> to <code>fd</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_global_extended_header"><a href="#val-write_global_extended_header" class="anchor"></a><code><span><span class="keyword">val</span> write_global_extended_header : 
  <span><span class="optlabel">?level</span>:<a href="../../tar/Tar/Header/index.html#type-compatibility">Tar.Header.compatibility</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../tar/Tar/Header/Extended/index.html#type-t">Tar.Header.Extended.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[ <span>`Msg of string</span> <span><span>| `Unix</span> of <span class="xref-unresolved">Unix</span>.error * string * string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>write_global_extended_header ~level hdr fd</code> writes the extended header <code>hdr</code> to <code>fd</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_end"><a href="#val-write_end" class="anchor"></a><code><span><span class="keyword">val</span> write_end : 
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <span>[ <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>write_end fd</code> writes the tar end marker to <code>fd</code>.</p></div></div></div></body></html>
